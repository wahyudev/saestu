!function(o){o.fn.checktree=function(){o(":checkbox").on("click",function(e){e.stopPropagation();var c=o(this),n=c.is(":checked"),t=c.closest("li"),i=t.parents("ul");t.find(":checkbox").prop("checked",n),i.each(function(){parent_ul=o(this),parent_state=parent_ul.find(":checkbox").length==parent_ul.find(":checked").length,parent_ul.siblings(":checkbox").prop("checked",parent_state)})})}}(jQuery);